<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cricket Admin Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Arial;background:#f2f4f8}
.header{background:#0a7cff;color:#fff;padding:14px;font-size:18px;text-align:center;font-weight:bold}
.box{background:#fff;margin:12px;border-radius:12px;padding:14px}
select,button{width:100%;padding:12px;margin:6px 0;font-size:16px}
button{background:#0a7cff;color:#fff;border:none;border-radius:8px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.live{background:#111;color:#0f0;padding:10px;border-radius:10px;font-size:14px;line-height:1.5}
.small{font-size:13px;color:#555;margin-top:4px}
</style>
</head>

<body>

<div class="header">üèè Cricket Admin Panel</div>

<div class="box">
  <label><b>Select Match</b></label>
  <select id="matchSelect"></select>
  <button onclick="loadMatch()">Load Match</button>

  <div class="small" id="matchInfo"></div>
</div>

<div class="box">
  <div class="grid">
    <button onclick="go('toss.html')">Toss</button>
    <button onclick="go('playing11.html')">Playing 11</button>
    <button onclick="go('openers.html')">Set Openers</button>
    <button onclick="go('index.html')">Live Scoring</button>
  </div>
</div>

<div class="box">
  <button onclick="startInnings()">Start 1st Innings</button>
  <button onclick="endInnings()">End Current Innings</button>
  <button onclick="startSecond()">Start 2nd Innings</button>
</div>

<div class="box">
  <div class="live" id="liveBox">Waiting match...</div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwoc84x0cmXWJ6GHzEae4kTJCMdEyvlK7NKq7m12oE6getykgU0UuUUpc37LZcoCuI/exec";
let MATCH_ID="";

/* Load matches */
fetch(`${API}?action=getMatches`)
.then(r=>r.json())
.then(d=>{
  let html='<option value="">-- Select Match --</option>';
  (d.matches||[]).forEach(m=>{
    html+=`<option value="${m.matchId}">${m.matchId}</option>`;
  });
  matchSelect.innerHTML=html;
});

/* Load match info */
function loadMatch(){
MATCH_ID=matchSelect.value;
if(!MATCH_ID)return alert("Select match");

fetch(`${API}?action=getMatch&matchId=${MATCH_ID}`)
.then(r=>r.json())
.then(m=>{
matchInfo.innerHTML=`
<b>${m.teamAId}</b> vs <b>${m.teamBId}</b><br>
Overs: ${m.overs}<br>
Venue: ${m.venue}<br>
Status: ${m.matchStatus}`;
});
}

/* Live preview */
function loadLive(){
if(!MATCH_ID)return;

fetch(`${API}?action=getLiveState&matchId=${MATCH_ID}`)
.then(r=>r.json())
.then(d=>{
if(d.status!=="ok")return;
liveBox.innerHTML=`
Score : ${d.totalRuns}-${d.wickets}<br>
Over : ${d.over}.${d.ball}<br>
Striker : ${d.strikerId}<br>
Bowler : ${d.bowlerId}<br>
State : ${d.state}`;
});
}
setInterval(loadLive,2000);

/* Navigation */
function go(p){
if(!MATCH_ID)return alert("Load match first");
window.location=p+`?matchId=${MATCH_ID}`;
}

/* Match actions */
function startInnings(){
fetch(`${API}?action=startFirstInnings&matchId=${MATCH_ID}`)
.then(r=>r.json())
.then(d=>alert(JSON.stringify(d)));
}
function endInnings(){
fetch(`${API}?action=endInnings&matchId=${MATCH_ID}`)
.then(r=>r.json())
.then(d=>alert("Innings Ended"));
}
function startSecond(){
fetch(`${API}?action=startSecondInnings&matchId=${MATCH_ID}`)
.then(r=>r.json())
.then(d=>alert("2nd Innings Started"));
}
</script>

</body>
</html>
